<!-- Copyright (c) Microsoft Corporation. All rights reserved. -->
<HTML DIR="LTR">

<HEAD>
	<TITLE>Assistant Classe MFC</TITLE>
	<META NAME="vs_targetSchema" CONTENT="http://schemas.microsoft.com/intellisense/ie5">
	<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
	<META HTTP-EQUIV="MSThemeCompatible" CONTENT="Yes">
	<LINK ID="LINKURL" REL="stylesheet" HREF="../../../../../1036/NewStyles.css">
</HEAD>

<BODY BGCOLOR="BUTTONFACE" TOPMARGIN="0" LEFTMARGIN="0" RIGHTMARGIN="0" BOTTOMMARGIN="0" ONLOAD="InitDocument(document);" ONKEYDOWN="OnKey();" ONKEYPRESS="OnPress();">

<TABLE CLASS="ONE" HEIGHT="100%" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
<COL CLASS="LinkPane"><COL>

  <!--OPEN OF INTRODUCTORY INFORMATION TABLE//-->
  <TR VALIGN="TOP">
	<TD HEIGHT="79" WIDTH="100%" COLSPAN="2">
	 <TABLE CLASS="TWO" BORDER="0" CELLPADDING="0" CELLSPACING="0">
	 <COL WIDTH="12"><COL><COL WIDTH="12">
	  <TR>
	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
	  	&nbsp;
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="12">
	  	&nbsp;
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
	  	&nbsp;
	   </TD>
  
	   <TD CLASS="IMAGE" VALIGN="BOTTOM" WIDTH="110" ROWSPAN="2">
		<DIV CLASS="SMALLA" ID="Layer0">
		 <IMG CLASS="SMALLEST" SRC="../../Images/MFCClass_1.gif" WIDTH="63" HEIGHT="63" ALT="" BORDER="0">
		</DIV>
	   </TD>

	   <TD VALIGN="TOP" HEIGHT="12" WIDTH="6" ROWSPAN="2">
	  	&nbsp;
	   </TD>
	  </TR>
	 
	  <TR>
	   <TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
	  	&nbsp;
	   </TD>
	  
	   <TD VALIGN="TOP" HEIGHT="65">
		<H4 CLASS="HEAD" ID="HEAD">Propriétés du modèle de document</H4>
		<P CLASS="SUBHEAD" ID="SUBHEAD">Spécifiez les valeurs que le modèle de document de votre application utilisera lors de la création d'un document.</P>
	   </TD>
	  
	   <TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
	  	&nbsp;
	   </TD>
	  </TR>
	 
	  <TR>
	   <TD VALIGN="TOP" CLASS="RULE" COLSPAN="5" HEIGHT="2">
		<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
	  	 <TR VALIGN="TOP">
	  	  <TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
	  	  <TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
	  	 </TR>
		</TABLE>
	   </TD>
	  </TR>
	 </TABLE>
	</TD>
  </TR>
  <!--CLOSE OF INTRODUCTORY INFORMATION TABLE//-->

  <!--OPEN OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
  <TR VALIGN="TOP">
	<TD CLASS="Three" VALIGN="TOP" HEIGHT="100%" WIDTH="100%">
	 <TABLE CLASS="fixedSize" HEIGHT="100%" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
  	  <TR VALIGN="TOP">
	   <TD CLASS="threeCustom" VALIGN="TOP">
	   <!--OPEN OF NAVIGATION TABLE//-->

	    <TABLE CLASS="THREE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
		<COL WIDTH="12"><COL><COL WIDTH="1">
		 <TR>
	   	  <TD VALIGN="TOP" COLSPAN="3" HEIGHT="12">
	  		&nbsp;
		  </TD>
		 </TR>
		 <TR>
	   	  <TD VALIGN="TOP" HEIGHT="100%">
	  		&nbsp;
		  </TD>
	   	  <TD VALIGN="TOP" HEIGHT="100%">
	   	  <!--OPEN OF NAVIGATIONAL LINKS//-->
			
			<DIV CLASS="LINK">
			 <TABLE WIDTH="100%" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXT">
			  <TR VALIGN="MIDDLE">
	  		   <TD WIDTH="100%">
				<SPAN CLASS="ACTIVELINK" ID="Default" TITLE="Spécifiez les noms de classe et de fichier ainsi que le type de classe à créer." onClick="Next(document, 'Default.htm');" TABINDEX="1">Noms</SPAN>
			   </TD>
	  		   <TD WIDTH="4">
			  	<IMG SRC="../../../../../1033/Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>
			
			<DIV CLASS="LINKSELECTED">
	 	   	 <SPAN CLASS="VERTLINE1">
			  <IMG SRC="../../../../../1033/Images/spacer.gif" WIDTH="1" HEIGHT="1" ALT="" BORDER="0">
			 </SPAN>
			 <SPAN CLASS="HORILINE1">
			  <TABLE WIDTH="167" HEIGHT="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			   <TR VALIGN="TOP">
			    <TD CLASS="DOTTEDLINE" HEIGHT="1">
				</TD>
			   </TR>
			   <TR VALIGN="TOP">
			    <TD HEIGHT="100%">
				 <IMG SRC="../../../../../1033/Images/spacer.gif" WIDTH="1" HEIGHT="28" ALT="" BORDER="0">
			    </TD>
			   </TR>
			   <TR VALIGN="TOP">
			    <TD CLASS="DOTTEDLINE" HEIGHT="1">
			    </TD>
			   </TR>
			  </TABLE>
			 </SPAN>
			 <TABLE WIDTH="160" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXTSELECTED">
			  <TR VALIGN="MIDDLE">
			   <TD WIDTH="100%">
				<SPAN ID="DocTemp" TITLE="Spécifiez les valeurs que le modèle de document de votre application utilisera lors de la création d'un document. Activé uniquement si la classe de base est CFormView et si 'Générer des ressources pour le modèle de document' est activé.">Propriétés du modèle de document</SPAN>
			   </TD>
			   <TD WIDTH="4">
				<IMG SRC="../../../../../1033/Images/spacer.gif" HEIGHT="1" WIDTH="4">
			   </TD>
			  </TR>
			 </TABLE>
			</DIV>
			
	   	  <!--CLOSE OF NAVIGATIONAL LINKS//-->
		  </TD>
		  <TD WIDTH="1">
		   <DIV CLASS="VERTLINE">
			 <IMG SRC="../../../../../1033/Images/spacer.gif" WIDTH="1" HEIGHT="1" ALT="" BORDER="0">
		   </DIV>
		  </TD>
		 </TR>
		 </TABLE>
		</TD>
	   </TR>
	   </TABLE>
			
	   <!--CLOSE OF NAVIGATION TABLE//-->
	   </TD>
  
	   <TD VALIGN="TOP" HEIGHT="100%">
	   <!--OPEN OF CONTENT AND BUTTON TABLE//-->
	   
	   	<TABLE CLASS="ONE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
		<COL WIDTH="100%">
		 <TR VALIGN="TOP">
		  <TD HEIGHT="100%">
	   	  <!--OPEN OF CONTENT//-->
		  
		  	<TABLE CLASS="CONTENT" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			<COL WIDTH="12"><COL WIDTH="398"><COL WIDTH="12">
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="9" COLSPAN="3">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			 <TR>
  			  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
			  <TD VALIGN="TOP">
 				<TABLE CLASS="CONTENTLINE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
				<COL><COL WIDTH="4"><COL>
 	 			 <TR>
  	  			  <TD VALIGN="TOP" ID="NONLOCALIZED_TD">
	  				<NOBR><B>Chaînes non localisées</B></NOBR>
	  			  </TD>
  	      		  <TD VALIGN="MIDDLE" WIDTH="4">
  					&nbsp;
  	      		  </TD>
  	  			  <TD VALIGN="MIDDLE" WIDTH="100%">
 	    			<TABLE CLASS="CONTENTLINE1" BORDER="0" CELLPADDING="0" CELLSPACING="0">
 	    			 <TR>
  	      			  <TD VALIGN="MIDDLE" WIDTH="100%">
  						<DIV CLASS="InLineA"></DIV>
	  					<DIV CLASS="InLineB"></DIV>
	      			  </TD>
		 			 </TR>
					</TABLE>
	  			  </TD>
	 			 </TR>
				</TABLE>
  			  </TD>
			  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			 <TR>
  			  <TD VALIGN="TOP" WIDTH="12" HEIGHT="9">
  				&nbsp;
  			  </TD>
			  <TD VALIGN="TOP" HEIGHT="9">
  				&nbsp;
  			  </TD>
 			  <TD VALIGN="TOP" WIDTH="12" HEIGHT="9">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			 <TR>
  			  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
 		 	  <TD VALIGN="TOP">
 				<TABLE CLASS="FixedSize" BORDER="0" CELLPADDING="0" CELLSPACING="0">
				<COL WIDTH="8"><COL WIDTH="185"><COL WIDTH="12"><COL WIDTH="185"><COL WIDTH="8">
 		 			<TR>
  		  			  <TD VALIGN="TOP" WIDTH="8">
  						 &nbsp;
  	 	 			  </TD>
					  <TD VALIGN="TOP">
  						<SPAN CLASS="itemText" ID="EXTENSION_SPAN" TITLE="Extension de fichier des documents de l'application.">
	    	 			 <LABEL FOR="DOCUMENT_FILE_EXTENSION" ID="DOCUMENT_FILE_EXTENSION_LABEL">E<u>x</u>tension de fichier :</LABEL>
	    	 			 <BR>
	    	 			 <INPUT CLASS="sideBtnB" TYPE="text" NAME="FileExt" ID="DOCUMENT_FILE_EXTENSION" ACCESSKEY="x" onPropertychange="SetFilter();" TITLE="Extension de fichier des documents de l'application." TABINDEX="2">
	  					 </SPAN>
	 	 			  </TD>
					  <TD VALIGN="TOP" WIDTH="12">
  						&nbsp;
  		  			  </TD>
				  <TD VALIGN="TOP">
  						<SPAN CLASS="itemText" ID="DOCTYPE_SPAN" TITLE="Identificateur du type de document à stocker dans la base de données d'inscription de Windows.">
	    	 			 <LABEL FOR="DOCUMENT_FILE_TYPE_ID" ID="DOCUMENT_FILE_TYPE_ID_LABEL"><U>I</U>D du type de fichier :</LABEL>
	    	 			 <BR>
	    	 			 <INPUT CLASS="sideBtnB" TYPE="text" NAME="FileID" ID="DOCUMENT_FILE_TYPE_ID" ACCESSKEY="i" TITLE="Identificateur du type de document à stocker dans la base de données d'inscription de Windows." TABINDEX="3">
	  					 </SPAN>
		  			  </TD>
  		  			  <TD VALIGN="TOP" WIDTH="8">
  						&nbsp;
  	 	 			  </TD>
 		 			</TR>
				</TABLE>
  			  </TD>
			  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			 <TR>
  			  <TD VALIGN="TOP" WIDTH="12" HEIGHT="17">
  				&nbsp;
  			  </TD>
 			  <TD VALIGN="TOP" HEIGHT="17">
  				&nbsp;
  			  </TD>
 			  <TD VALIGN="TOP" WIDTH="12" HEIGHT="17">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			 <TR>
  			  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP">
 				<TABLE CLASS="CONTENTLINE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
				<COL><COL WIDTH="4"><COL>
 	 			 <TR>
  	  			  <TD VALIGN="TOP" ID="LOCALIZED_TD">
	  				<NOBR><B>Chaînes localisées</B></NOBR>
	  			  </TD>
  	      		  <TD VALIGN="MIDDLE" WIDTH="4">
  					&nbsp;
  	      		  </TD>
  	  			  <TD VALIGN="MIDDLE" WIDTH="100%">
 	    			<TABLE CLASS="CONTENTLINE1" BORDER="0" CELLPADDING="0" CELLSPACING="0">
 	    			 <TR>
  	      			  <TD VALIGN="MIDDLE" WIDTH="100%">
  						<DIV CLASS="InLineA"></DIV>
	  					<DIV CLASS="InLineB"></DIV>
	      			  </TD>
		 			 </TR>
					</TABLE>
	  			  </TD>
	 			 </TR>
				</TABLE>
  			  </TD>
 	 		  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			 <TR>
  			  <TD VALIGN="TOP" WIDTH="12" HEIGHT="9">
  				&nbsp;
  			  </TD>
			  <TD VALIGN="TOP" HEIGHT="9">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP" WIDTH="12" HEIGHT="9">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			 <TR>
  			  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP">
 				<TABLE CLASS="FixedSize" BORDER="0" CELLPADDING="0" CELLSPACING="0">
				<COL WIDTH="8"><COL WIDTH="185"><COL WIDTH="12"><COL WIDTH="185"><COL WIDTH="8">
 		 			<TR>
  		  			  <TD VALIGN="TOP" WIDTH="8">
  						&nbsp;
  	 	 			  </TD>
  	 	 			   <TD VALIGN="TOP">
  						<SPAN CLASS="itemText" ID="ROOT_SPAN" TITLE="Nom racine pour un nouveau fichier de document. Il s'agit par défaut de &quot;Sans titre&quot;.">
	    	 			 <LABEL FOR="DOCUMENT_TYPE_NAME" ID="DOCUMENT_TYPE_NAME_LABEL">N<U>o</U>m du type de document :</LABEL>
	    	 			 <BR>
	    	 			 <INPUT CLASS="sideBtnB" TYPE="text" NAME="DocTypeName" ID="DOCUMENT_TYPE_NAME" ACCESSKEY="o" TITLE="Nom racine pour un nouveau fichier de document. Il s'agit par défaut de &quot;Sans titre&quot;." TABINDEX="4">
	  					</SPAN>
	
	  					<P CLASS="ElementSpacer2">&nbsp;</P>
	  
	  					<SPAN CLASS="itemText" ID="SHORTNAME_SPAN"TITLE="Nom court de ce type de document, sous la forme &quot;Feuille&quot;.">
	    	 			 <LABEL FOR="DOCUMENT_FILE_NEW_NAME_SHORT" ID="DOCUMENT_FILE_NEW_NAME_SHORT_LABEL">Nom <u>c</u>ourt de nouveau fichier :</LABEL>
	    	 			 <BR>
	    	 			 <INPUT CLASS="sideBtnB" TYPE="text" NAME="FileNameShort" ID="DOCUMENT_FILE_NEW_NAME_SHORT" ACCESSKEY="c" TITLE="Nom court de ce type de document, sous la forme &quot;Feuille&quot;." TABINDEX="6">
	  					</SPAN>

	  					<P CLASS="ElementSpacer2">&nbsp;</P>

						<SPAN CLASS="itemText" ID="DOCUMENT_CLASS_SPAN" TITLE="Nom de la classe de document à associer à ce modèle de document.">
							 <LABEL FOR="DOCUMENT_CLASS" ID="DOCUMENT_CLASS_LABEL">Classe de <U>d</U>ocument :</LABEL>
							 <BR>
							 <SELECT CLASS="sideBtnThreeColumn" ID="DOCUMENT_CLASS" SIZE="1" ACCESSKEY="D" TITLE=""></SELECT>
						</SPAN>
	 	 			  </TD>
	  				  <TD VALIGN="TOP" WIDTH="12">
  						&nbsp;
  		  			  </TD>
	  				  <TD VALIGN="TOP">
  						<SPAN CLASS="itemText"  ID="FILTER_SPAN" TITLE="Type de document et filtre à caractères génériques, par exemple &quot;Feuilles de calcul (*.xls)&quot;.">
	 	  	 			 <LABEL FOR="DOCUMENT_FILTER_NAME" ID="DOCUMENT_FILTER_NAME_LABEL">Nom de <U>f</U>iltre :</LABEL>
	  		 			 <BR>
	  		 			 <INPUT CLASS="sideBtnB" TYPE="text" NAME="FilterName" ID="DOCUMENT_FILTER_NAME" ACCESSKEY="F" TITLE="Type de document et filtre à caractères génériques, par exemple &quot;Feuilles de calcul (*.xls)&quot;." TABINDEX="5">
						</SPAN>
	
	  					<P CLASS="ElementSpacer2">&nbsp;</P>
	  
						<SPAN CLASS="itemText" ID="DOCTYPENAME_SPAN" TITLE="Nom du type de document à stocker dans la base de données d'inscription.">
	  		 			 <LABEL FOR="DOCUMENT_FILE_NEW_NAME_LONG" ID="DOCUMENT_FILE_NEW_NAME_LONG_LABEL">Nom <U>l</U>ong du type de fichier :</LABEL>
	  		 			 <BR>
	  		 			 <INPUT CLASS="sideBtnB" TYPE="text" NAME="FileNameLong" ID="DOCUMENT_FILE_NEW_NAME_LONG" ACCESSKEY="l" TITLE="Nom du type de document à stocker dans la base de données d'inscription." TABINDEX="7">
    					</SPAN>
		  			  </TD>
  		  			  <TD VALIGN="TOP" WIDTH="8">
  						&nbsp;
  	 	 			  </TD>
 		 			</TR>
				</TABLE>
  			  </TD>
  			  <TD VALIGN="TOP" WIDTH="12">
  				&nbsp;
  			  </TD>
			 </TR>
 
 			 <TR>
  			  <TD VALIGN="TOP" WIDTH="12" HEIGHT="100%">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP" HEIGHT="100%">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP" WIDTH="12" HEIGHT="100%">
  				&nbsp;
  			  </TD>
 			 </TR>
			</TABLE>
			
	   	  <!--CLOSE OF CONTENT//-->
		  </TD>
		 </TR>
		 <TR VALIGN="BOTTOM">
		  <TD>
	   	  <!--OPEN OF BUTTON HTML//-->
		  
		  	<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0">
			<COL WIDTH="12"><COL><COL WIDTH="75"><COL WIDTH="4"><COL WIDTH="75"><COL WIDTH="4"><COL WIDTH="75"><COL WIDTH="12">
			 <TR>
  			  <TD VALIGN="TOP" CLASS="RULE" COLSPAN="8" HEIGHT="2">
				<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
  	 			 <TR VALIGN="TOP">
  	  			  <TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
  	  			  <TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
  	 			 </TR>
				</TABLE>
  			  </TD>
 			  </TR>
 
 			  <TR>
  			  <TD VALIGN="TOP" HEIGHT="11" COLSPAN="8">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			<TR>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="TOP" HEIGHT="23">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="FinishBtn" onClick="OnFinish(document);">Terminer</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="CancelBtn" onClick="window.external.Finish(document, 'cancel');">Annuler</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
  				&nbsp;
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
  				<BUTTON CLASS="BUTTONS" ID="HelpBtn" onClick="window.external.OnHelp('vc.codewiz.class.mfc.simple.doctemp');">Aide</BUTTON>
  			  </TD>
  			  <TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
  				&nbsp;
  			  </TD>
 			 </TR>
 
 			 <TR>
  			  <TD VALIGN="TOP" HEIGHT="12" COLSPAN="8">
  				&nbsp;
  			  </TD>
 			 </TR>
			</TABLE>
			
	   	  <!--CLOSE OF BUTTON HTML//-->
		  </TD>
		 </TR>
		</TABLE>
	
	   <!--CLOSE OF CONTENT AND BUTTON TABLE//-->
	   </TD>
	  </TR>
	 </TABLE>
	
	<!--CLOSE OF ALL ENCOMPASSING TABLE ROW TWO//-->
	</TD>
	</TR>
	</TABLE>

</BODY>
</HTML>

<SCRIPT LANGUAGE="JSCRIPT">

var tab_array = new Array();
tab_array[0] = Default;
tab_array[1] = DocTemp;

var ProjName = window.external.FindSymbol("PROJECT_NAME");

function AddDocumentClasses(document)
{
	var oClasses = window.external.ProjectObject.CodeModel.GetClassesDerivedFrom("CDocument");
	if (oClasses != null)
	{
		for (var nCntr = 1; nCntr <= oClasses.Count; nCntr++)
		{
			var oClass = oClasses(nCntr);
			var oOption = document.createElement("OPTION");
			oOption.text = oClass.FullName;
			oOption.value = oClass.FullName;
			DOCUMENT_CLASS.add(oOption);
		}
	}
}

function InitDocument(document)
{
	setDirection();
	
	window.external.Load(document);

	var max = new Number;
	max = window.external.FindSymbol("MAX_DOC_TYPE_NAME");
	DOCUMENT_TYPE_NAME.maxLength = max;

	max = window.external.FindSymbol("MAX_FILE_NEW_NAME_SHORT");
	DOCUMENT_FILE_NEW_NAME_SHORT.maxLength = max;

	max = window.external.FindSymbol("MAX_FILE_TYPE_ID");
	DOCUMENT_FILE_TYPE_ID.maxLength = max;

	max = window.external.FindSymbol("MAX_FILE_NEW_NAME_LONG");
	DOCUMENT_FILE_NEW_NAME_LONG.maxLength = max;

	max = window.external.FindSymbol("MAX_FILTER_NAME");
	DOCUMENT_FILTER_NAME.maxLength = max;

	if (window.external.FindSymbol("DOCUMENT_FILE_EXTENSION").length == 0)
	{
		var strClassName = window.external.FindSymbol("CLASS_NAME");
		DOCUMENT_TYPE_NAME.value = strClassName;
		if (strClassName.length > 3)
		{
			DOCUMENT_FILE_EXTENSION.value = strClassName.substr(0,3).toLowerCase();
			DOCUMENT_FILTER_NAME.value = strClassName + " Files (*." + strClassName.substr(0,3).toLowerCase() + ")";
		}
		else
		{
			DOCUMENT_FILE_EXTENSION.value = strClassName.toLowerCase();
			DOCUMENT_FILTER_NAME.value = strClassName + " Files (*." + strClassName.toLowerCase() + ")";
		}
		DOCUMENT_FILE_TYPE_ID.value = strClassName + ".Document";
		DOCUMENT_FILE_NEW_NAME_SHORT.value = strClassName;
		DOCUMENT_FILE_NEW_NAME_LONG.value = strClassName + " Document";
	}

	AddDocumentClasses(document);

	DOCUMENT_CLASS.selectedIndex = 0;
}

function Next(document, linkto)
{
	window.external.Next(document, linkto);
}

function OnFinish(document)
{
	bValidating = true;
	if (!ValidateInput())
	{
		bValidating = false;
		return;
	}

	if (window.external.FindSymbol("CLASS_NAME").length == 0)
	{
		L_Err1_Text = "Vous devez spécifier un nom de classe.";
		window.external.ReportError(L_Err1_Text);
		Next(document, "default.htm");
		return;
	}

	OnWizFinish(document);
}

function SetFilter()
{
	var strExtension = DOCUMENT_FILE_EXTENSION.value;
	if (strExtension == "")
		DOCUMENT_FILTER_NAME.value = strExtension;
	else
		DOCUMENT_FILTER_NAME.value = ProjName + " Files (*." + strExtension + ")";
}

function ValidateInput()
{
	var oInvalid = null;

	if (!Validate(DOCUMENT_FILE_EXTENSION))
		oInvalid = DOCUMENT_FILE_EXTENSION;

	if (oInvalid == null)
		if (!Validate(DOCUMENT_TYPE_NAME))
			oInvalid = DOCUMENT_TYPE_NAME;

	if (oInvalid == null)
		if (!Validate(DOCUMENT_FILE_TYPE_ID))
			oInvalid = DOCUMENT_FILE_TYPE_ID;

	if (oInvalid != null)
	{
		window.external.ReportError();
		oInvalid.focus();
		return false;
	}
	return true;
}

function ValidateFileExtention(strExt)
{
	if(!window.external.dte.VCLanguageManager.ValidateFileName(strExt, vsCMValidateFileExtNone))
		return false;

	if(strExt.charAt(strExt.length - 1) == '.')
	{
		L_Err2_Text = "L'extension d'un fichier ne peut pas se terminer par un point.";
		oErrObj = new Error(L_Err2_Text);
		SetErrorInfo(oErrObj);
		return false;
	}
	return true;
}

function Validate(obj)
{
	var bValid = true;
	switch(obj.id)
	{
		case "DOCUMENT_FILE_EXTENSION":
		case "DOCUMENT_TYPE_NAME":
			if (obj.value == "")
			{
				L_Err3_Text = "Valeur non valide";
				oErrObj = new Error(L_Err3_Text);
				SetErrorInfo(oErrObj);
				bValid = false;
			}
			else
				bValid = ValidateFileExtention(obj.value);
			break;
		case "DOCUMENT_FILE_TYPE_ID":
			if (obj.value == "")
			{
				L_Err4_Text = "Valeur non valide";
				oErrObj = new Error(L_Err4_Text);
				SetErrorInfo(oErrObj);
				bValid = false;
			}
			else
				bValid = window.external.IsValidProgID(obj.value);
			break;
		default:
			break;
	}

	if (typeof(bValid) == "undefined")
		bValid = false;

	return bValid;
}

</SCRIPT>
<SCRIPT ID="INCLUDE_SCRIPT" LANGUAGE="JSCRIPT"></SCRIPT>
<SCRIPT ID="INCLUDE_COMMON" LANGUAGE="JSCRIPT"></SCRIPT>
<SCRIPT>
	document.scripts("INCLUDE_SCRIPT").src = window.external.FindSymbol("SCRIPT_COMMON_PATH") + "/Script.js";
	document.scripts("INCLUDE_COMMON").src = window.external.FindSymbol("SCRIPT_COMMON_PATH") + "/Common.js";
</SCRIPT>
